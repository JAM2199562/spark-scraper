# Spark Token Scraper

一个用于监控 Spark 平台新代币创建的爬虫程序。

## 功能特性

- 🔍 自动监控新创建的代币
- 🌐 支持浏览器模拟和直接API调用两种方式
- ⏰ 可配置的监控间隔时间
- 🖥️ 支持显示浏览器窗口用于调试
- 📊 实时打印新代币的名称、符号和合约地址

## 安装和运行

### 1. 安装依赖

确保已安装 [uv](https://github.com/astral-sh/uv)，然后运行：

```bash
uv sync
```

### 2. 安装 Playwright 浏览器

```bash
uv run playwright install chromium
```

### 3. 配置环境变量（可选）

复制配置文件：
```bash
cp .env.example .env
```

编辑 `.env` 文件设置您的配置：

- `CHECK_INTERVAL_MINUTES`: 检查间隔时间（分钟），默认5分钟
- `BROWSER_HEADLESS`: 是否隐藏浏览器窗口，`false`=显示（调试用），`true`=隐藏

### 4. 运行程序

```bash
uv run python main.py
```

## 程序工作流程

1. **首次启动**：显示过去30分钟内创建的代币，帮助了解当前状态
2. **持续监控**：每隔指定时间（默认5分钟）检查一次新代币
3. **浏览器优化**：浏览器启动一次后保持打开，避免重复初始化的开销
4. **智能检测**：自动识别真正的新代币，避免重复报告
5. **双重保障**：优先使用浏览器方式，失败时自动切换到直接API调用

## 输出示例

```
🚀 Spark代币监控器启动!
📡 监控地址: https://regtest.luminex.pages.dev/spark/pulse
⏰ 检查间隔: 5 分钟
🔍 浏览器模式: 可见
🔄 浏览器将保持打开状态，避免重复初始化
================================================================================

🔧 初始化浏览器...
✅ 浏览器初始化完成

[18:01:23] 首次启动，检查过去30分钟内的新代币...
正在访问页面: https://regtest.luminex.pages.dev/spark/pulse
捕获到API响应，包含 20 个代币

📈 过去30分钟内创建的代币 (2 个):
--------------------------------------------------------------------------------
代币名称: Grande Coin
代币符号: MUCHO
合约地址: btknrt17papwmvs6gd73ncwnqynq9zdc84h87uhgl6rsr0uwqjl0d04v8uskjylm6
创建时间: 2025-08-10T08:51:18.597759+00:00
--------------------------------------------------------------------------------
代币名称: Dog
代币符号: DOG  
合约地址: btknrt16j64ykxfy8k9c84z6z5w6nuxfqksl9wdghmg29zuz367xzk6mtxqhhh0dl
创建时间: 2025-08-10T08:46:55.481943+00:00
--------------------------------------------------------------------------------

⏱️  等待 5 分钟后进行下次检查...

[18:06:23] 开始检查新代币...
正在访问页面: https://regtest.luminex.pages.dev/spark/pulse
捕获到API响应，包含 21 个代币

🎉 发现 1 个新代币:
--------------------------------------------------------------------------------
代币名称: New Token
代币符号: NEW
合约地址: btknrt1abcdefg...
创建时间: 2025-08-10T09:05:00.000000+00:00
--------------------------------------------------------------------------------
```

## 注意事项

1. 首次运行时所有代币都会被识别为"新"代币
2. 程序会记住已经见过的代币，避免重复报告
3. 使用 `Ctrl+C` 可以安全退出程序
4. 建议在稳定的网络环境下运行

## 故障排除

如果遇到依赖安装问题，可以手动安装：

```bash
uv add playwright requests python-dotenv
uv run playwright install chromium
```

如果网络连接有问题，程序会自动重试。